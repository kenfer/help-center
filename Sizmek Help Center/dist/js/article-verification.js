$(document).ready(function(){var v,e,t=HelpCenter.user.role;window.localStorage,window.sessionStorage,window.location.href.split("--")[0];if(-1<window.location.href.indexOf("/articles/")&&"end_user"!=t&&"anonymous"!=t){var l=["January","February","March","April","May","June","July","August","September","October","November","December"],u=(HelpCenter.user.locale,357520165),m=window.location.href.split("articles/")[1].split("#")[0].split("-")[0].split("?")[0],f=!0;$("#sideNavigation").prepend('<div id="article-verification"><div class="av-trusted" id="av-header" v-toggle="av-closed"><i class="fa fa-check"></i><span class="av-status">TRUSTED</span><div class="v-toggle"><span class="fa fa-angle-down"></span></div></div><div class="av-body"><div class="av-body-item"><div class="av-title"><i class="fa fa-user"></i><span>LAST VERIFIED BY</span></div><strong class="av-detail" id="av-last-verifier">YOU</strong></div><div class="av-body-item"><div class="av-title"><i class="fa fa-calendar-check-o"></i><span>LAST VERIFIED ON</span></div><strong class="av-detail" id="av-last-vdate">February 12, 2018</strong></div><div class="av-body-item"><div class="av-title"><i class="fa fa-calendar"></i><span>VERIFICATION INTERVAL</span></div><div class="av-interval-error"><span>PLEASE SELECT AN INTERVAL</span></div><select class="select-picker" id="av-interval-select" name=""><option value="0">NO INTERVAL CHOSEN</option><option value="1">Every month</option><option value="2">Every 2 months</option><option value="3">Every 3 months</option><option value="4">Every 4 months</option><option value="6">Every 6 months</option><option value="12">Every 12 months</option></select></div><div class="av-body-item av-related-tickets"><div class="av-title"><i class="fa fa-ticket"></i><span>TICKETS</span><span class="av-verify-error" style="display:none">RESOLVE TICKETS FIRST</span></div><strong class="av-detail noTickets">NO TICKETS</strong><table><thead><tr><th>TICKET ID</th><th>DATE</th></tr></thead><tbody id="av-open-related-tickets"></tbody></table></div><div class="verify-article"><div class="av-alert"><span>Please resolve tickets.</span></div><button type="button" id="av-verify-article" name="button"><span>VERIFY ARTICLE</span></button></div></div></div> '),$("#article-verification").hide(),$("#filterContent").css("border-top","1px solid #183e6c"),$("#article-verification #av-header").click(function(){"av-closed"==$(this).attr("v-toggle")?($(this).attr("v-toggle","av-open"),$(this).find(".v-toggle .fa").removeClass("fa-angle-down").addClass("fa-angle-up"),$(".av-body").slideDown("fast")):($(this).attr("v-toggle","av-closed"),$(this).find(".v-toggle .fa").addClass("fa-angle-down").removeClass("fa-angle-up"),$(".av-body").slideUp("fast"))});window.location.href.split("/");e=(e=window.location.href.split("/"))[e.length-1].split("-",1).toString(),$.get("/api/v2/search.json?query=custom_field_24296573:"+e).done(function(p){$.get("/api/v2/help_center/articles/"+m+"/labels.json").done(function(e){for(var t=0,a=0,i=0,n=0;n<p.count;n++)if("open"==p.results[n].status||"new"==p.results[n].status){$(".av-related-tickets .noTickets").hide(),t++;var s=p.results[n].id,d=(p.results[n].subject,p.results[n].status),l=(p.results[n].requester_id,new Date(p.results[n].updated_at)),c='<span class="ticket_status_label ticket-status ticket-status-'+d+'" title="'+d+'">'+d.charAt(0).toLowerCase()+"</span>",o='<tr class="related-tickets-item"><td><a href="/agent/tickets/'+s+'" target="_blank">'+c+"&nbsp;#"+s+"</a></td><td>"+l.toDateString()+"</td></tr>";$("#av-open-related-tickets").append(o),-1<p.results[n].tags.indexOf("review_a_flagged_article")&&a++,-1<p.results[n].tags.indexOf("article_flagged_reason_outdated_information")&&i++}0<t?(k(2),$(".av-related-tickets").find("table").show()):($(".av-related-tickets").find("table").hide(),k(1)),0<a&&k(5),0<i&&k(6);for(var n=0,r=0;n<e.labels.length&&0==r;n++)0==e.labels[n].name.indexOf("!av::details::")&&(r=1,v=e.labels[n].name.split("::"));1==r?($("#av-last-verifier").text(v[4]),$("#av-interval-select").val(parseInt(v[3])),y($("#av-interval-select").val()),function(e,t){var a=parseInt(t),i=new Date,n=new Date(e),s=new Date(e);s.setMonth(s.getMonth()+a);var d=c(n,s),l=c(i,s);function c(e,t){var a=Math.round((t-e)/864e5);return a}0<(h=l)?l>=Math.round(.1*d)?(k(1),$("#av-header .av-status").text("TRUSTED")):(k(4),$("#av-header").find(".av-status").text("WARNING 10%")):(k(6),$("#av-header .av-status").text("EXCEEDED"),$(".av-verify").show(),checkOutdatedTicket())}(v[2],v[3]),g(v[2]),1):($("#av-last-verifier").text("NONE"),$("#av-last-vdate").text("NONE"),k(3),0),T(b),function(e){-1<HelpCenter.user.tags.indexOf("view_support_content")?$("#article-verification").show():($("#article-verification").hide(),"support_kb"!=$("switchTag").val()?$(".sub-nav , #sideNavigation ").css("border-top","3px solid #00e8c6"):$(".main , #sideNavigation ").css("border-top","3px solid #00e8c6"));var b=201265859;function d(){$("select.time-select").each(function(){if(""==$(this).text())for(x=1;x<=24;x++){var e=x;x<10&&(e="0"+x);var t="<option>"+e+":00</option>";$(this).append(t)}})}function a(){console.log("viewIncidents"),$.get("/api/v2/help_center/articles/"+m+".json",function(e){console.log(e);for(var t=e.article.section_id,a=e.article.created_at,i=e.article.body,n=new Date(a),s=0;s<e.article.label_names.length;s++){if(-1<e.article.label_names[s].indexOf("Severity:"))var d=e.article.label_names[s].replace("Severity:","");if(-1<e.article.label_names[s].indexOf("Status:"))var l=e.article.label_names[s].replace("Status:","");if(-1<e.article.label_names[s].indexOf("Type:"))var c,o=e.article.label_names[s].replace("Type:","")}c="Incident"==o?($(".article-header h1").css("color",["#7EDE96","#3498DB","#FFD24D","#DC7633","#E74C3C"][d-1]),$(".article-header h1").attr("id","incident-title-"+d),"update-incident-btn"):($(".article-header h1").css("color","rgb(52, 152, 219)"),"update-maintenance-btn"),$(".incident-wrapper").append($(".main-column")),$('<div class="incident-list-cont show"></div>').insertAfter(".article-info"),$(".incident-list-cont").append("<div class='incident-list'></div>"),$(".incident-list").append("<div class='incident-list-item'></div>"),$(".incident-list-item").append("<div class='incident-item-body'><h5>"+l+"</h5></div><div class='edit_update'><a>Edit</a></div>"),$($(".article-body.markdown")).insertBefore(".edit_update"),$(".article-body.markdown").append('<br><small class="small">'+n.toDateString()+" "+n.toLocaleTimeString()+'</small><span class="hide span-body">'+i+"</span>"),$(".incident-list-cont.show").append('<a id="delete-incident-btn" class="incident-subscribe-button incident-delete-button">DELETE<span class="hide">'+m+'</span></a><a id="'+c+'" class="incident-subscribe-button incident-update-button">UPDATE<span class="hide">'+m+'</span><span style="display:none" id="platform_id">'+t+'</span></a><a id="back-incident-list" class="plain-button" href="https://support.sizmek.com/hc/en-us/categories/201680143-Message-Board"><br><span style="font-family:arial">‚Üê</span> Incidents</a></div></div>'),$(".incident-list").html('<div class="incident-list-item"><div class="incident-item-body"><h5>Investigating</h5></div><div class="article-body markdown">'+i+'<br><small class="small">Posted on '+n.toDateString()+" "+n.toLocaleTimeString()+'</small><span class="hide">'+i+'<span></div><div class="edit_body"><a>Edit</a></div></div>')&&$.get("/api/v2/help_center/articles/"+m+"/comments.json",function(e){for(var t=e.comments.length-1;0<=t;t--){var a=e.comments[t].id,i=e.comments[t].updated_at,n=new Date(i),s=e.comments[t].body,d=s.split(r(s),1),s=s.substr(s.indexOf(p(s))+1);$(".incident-list").prepend('<div class="incident-list-item"><div class="incident-item-body"><h5>'+d+'</h5></div><div class="incident-item-cont">'+s+'<br><small class="small">Posted on '+n.toDateString()+" "+n.toLocaleTimeString()+'</small><span class="hide span-body">'+s+'</span></div><div class="edit_update"><a>Edit<span class="hide">'+a+'</span></a></div><div class="delComment"><a>Delete<span class="hide">'+a+"</span></a></div></div>")}})})}function r(e){var t=e.indexOf(":"),a=e.indexOf("-");return-1<t?-1<a?t<a?":":" -":":":" -"}function p(e){var t=e.indexOf(":"),a=e.indexOf("-");return-1<t?-1<a?t<a?":<br><br>":"- ":":<br><br>":"- "}$(".article-header").append('<span class="currArticle hide">'+m+"</span>"),$.get("/api/v2/help_center/articles/"+m+".json",function(e){for(var t=0;t<e.article.label_names.length;t++)if(-1<e.article.label_names[t].indexOf("Type:Maintenance")||-1<e.article.label_names[t].indexOf("Type:Incident")){a(),$("footer.article-footer").remove(),$("form.comment-form").remove(),$(".article-comments").remove();break}}),$("body").on("click","#delete-incident-btn",function(e){if(confirm("Delete this incident?")){var t=$(this).find("span.hide").text();$.ajax({url:"/api/v2/help_center/articles/"+t+".json",type:"DELETE"}),setTimeout(function(){window.location.href="https://support.sizmek.com/hc/en-us/categories/201680143-Message-Board"},500)}}),$("body").on("click","#update-incident-status",function(e){$(this).attr("disabled","disabled");var t=$(".modal-body"),a=$(this).find("span.hide").text(),i=$(".internal").find("span#incident-id").text();function n(a,e,t){var i=$("#update-incident-modal:visible .incident-severity select").val(),n=$(".status-choices input[name=status-choices]:checked").val(),s=$("#update-incident-body-external").val(),d=$('input[type="checkbox"]#send-comment-notif').is(":checked"),l=t;e&&(s=$("#update-incident-body-internal").val());var c=l.substr(l.indexOf("] ")+1);if($("#send-time").is(":visible")&&$("#send-time").is(":checked"))var o=$('#update-incident-modal .maintenance-start input[type="date"]').val()+" "+$("#update-incident-modal .maintenance-start select").val(),r=$('#update-incident-modal .maintenance-end input[type="date"]').val()+" "+$("#update-incident-modal .maintenance-end select").val(),p=n+" - <strong>Maintenance Start: "+o+"</strong><br><strong>Maintenance End: "+r+"</strong><br><br>"+s;else var p=n+" - "+s;if(null==n)return alert("Please select status."),$(this).removeAttr("disabled"),!1;$.ajax({url:"/api/v2/help_center/articles/"+a+"/translations/en-us.json",type:"PUT",data:{translation:{title:"["+n+"] "+c}}}),setTimeout(function(){$.get("/api/v2/help_center/articles/"+a+"/labels.json",function(e){for(var t=0;t<e.labels.length;t++)-1<e.labels[t].name.indexOf("Severity:")&&($.ajax({url:"/api/v2/help_center/articles/"+a+"/labels/"+e.labels[t].id+".json",type:"DELETE"}),setTimeout(function(){$.ajax({url:"/api/v2/help_center/articles/"+a+"/labels.json",type:"POST",data:{label:{name:"Severity:"+i}}})},1e3))})},500),setTimeout(function(){$.get("/api/v2/help_center/articles/"+a+"/labels.json",function(e){for(var t=0;t<e.labels.length;t++)-1<e.labels[t].name.indexOf("Status:")&&($.ajax({url:"/api/v2/help_center/articles/"+a+"/labels/"+e.labels[t].id+".json",type:"DELETE"}),setTimeout(function(){$.ajax({url:"/api/v2/help_center/articles/"+a+"/labels.json",type:"POST",data:{label:{name:"Status:"+n}}})},1e3))})},500),setTimeout(function(){$.ajax({url:"/api/v2/help_center/articles/"+a+"/comments.json",type:"POST",data:{comment:{body:p,author_id:u,locale:"en-us"},notify_subscribers:d},success:function(){if($("#update-incident-modal").remove(),location.reload(),$(this).removeAttr("disabled"),$(".messageBoard .incident-view-page").is(":visible"))return!1;$("html").css("overflow","auto")}})},2e3)}$(this).attr("disabled","disabled"),$("#update-incident-modal .global-notifications").is(":visible")&&$("#update-incident-modal .global-notifications input.subscribe-global-notif").is(":checked")&&$.ajax({url:"/api/v2/help_center/sections/"+b+"/subscriptions.json",type:"POST",data:{subscription:{source_locale:"en-us",include_comments:!0,user_id:357520165}}}),f&&n(i,!0,$(".internal").find("#internal-title").text()),a!==i&&n(a,!1,$(this).find("#incident-title").text()),t.find('.components-affected-update input[type="checkbox"]:checked').each(function(){n($(this).val(),!1,$(this).parent().find("#incident-title").text())})}),$("body").on("click",".close-modal",function(e){if($(this).closest(".modal").remove(),"hidden"!==$("html").css("overflow"))return!1;$("html").css("overflow","scroll")}),$("body").on("click","#update-maintenance-btn",function(e){var t=$(this).find("span.hide").text();platform=$(this).find("span#platform_id").text(),start_date=$(".incident-view-page .incident-list-item:last-child .incident-item-cont span strong:first-child").text(),end_date=$(".incident-view-page .incident-list-item:last-child .incident-item-cont span strong:nth-child(3)").text(),start_date=start_date.replace("Maintenance Start: ","").split(" ",2),end_date=end_date.replace("Maintenance End: ","").split(" ",2),$("html").css("overflow","hidden"),$("body").append('<div class="modal" id="update-incident-modal"> <div class="modal-content"> <div class="modal-header"><button class="close close-modal">X</button><h1>Update Maintenance Status </h1></div> <div class="modal-body"> <div class="modal-body-detail"> <label>Maintenance Status </label> <div class="status-choices"> <input type="radio" id="mc1" name="status-choices" value="New"> <label class="radio-label" for="mc1">New </label> <input type="radio" id="mc2" name="status-choices" value="Updated"> <label class="radio-label" for="mc2">Updated </label> <input type="radio" id="mc3" name="status-choices" value="Completed"> <label class="radio-label" for="mc3">Completed </label> </div> </div> <div class="modal-body-detail"> <label>Message </label> <br> <textarea id="update-incident-body" placeholder="Message"> </textarea> </div> <div> <input type="checkbox" id="send-time"> <label for="send-time" style="font-weight: 400;font-size: 15px;">Update time. </label> </div> <div class="maintenance-start"> <label>Maintenance Start Time </label> <div class="maintenance-time"> <input disabled type="date" value="'+start_date[0]+'"> <select disabled class="time-select"></select> </div> <span class="info">All times must be specified in EST - Eastern Standard Time(US &amp; Canada) </span> </div> <div class="maintenance-end"> <label>Maintenance End Time </label> <div class="maintenance-time"> <input disabled value="'+end_date[0]+'" type="date"> <select disabled class="time-select"></select> </div> <span class="info">All times must be specified in EST - Eastern Standard Time(US &amp; Canada) </span> </div> <div class="modal-body-detail"> <label>Notifications </label> <br> <input type="checkbox" checked id="send-comment-notif"> <label for="send-comment-notif" style="font-weight: 400">Send alert to subscribers about this update. </label></div></div><div class="modal-footer"><button class="btn btn-primary" id="update-incident-status">UPDATE STATUS <span class="hide">'+t+" </span> </button></div></div></div>"),$("#update-incident-modal").fadeIn("fast"),d(),$("textarea#update-incident-body").ckeditor(),$("#update-incident-modal .maintenance-start .time-select").val(start_date[1]),$("#update-incident-modal .maintenance-end .time-select").val(end_date[1]),setTimeout(function(){$("#update-incident-modal").find("textarea").val("")},500),$("textarea#update-incident-body").ckeditor(),CKEDITOR.instances["update-incident-body"].on("instanceReady",function(e){setTimeout(function(){CKEDITOR.instances["update-incident-body"].plugins.lite.findPlugin(CKEDITOR.instances["update-incident-body"]).toggleTracking(!1,!1),$("#update-incident-modal").find("textarea").val(""),$("#update-incident-modal").fadeIn("fast")},300)}),"201265859"===$("span#platform_id").text()&&$('<div class="modal-body-detail global-notifications"><label>Global Notifications</label><br><input type="checkbox" checked class="subscribe-global-notif"><span class="checkbox-label">Subscribe globalnotifications@sizmek.com.</span></div>').insertAfter("#update-incident-modal .maintenance-end"),$("body").on("click","#update-incident-modal .close-modal",function(e){if($(this).closest(".modal").remove(),"hidden"!==$("html").css("overflow"))return!1;$("html").css("overflow","scroll")})}),$("body").on("change","#send-time",function(){$(this).is(":checked")?($("#update-incident-modal .maintenance-start input, #update-incident-modal .maintenance-start select").removeAttr("disabled"),$("#update-incident-modal .maintenance-end input, #update-incident-modal .maintenance-end select").removeAttr("disabled")):($("#update-incident-modal .maintenance-start input, #update-incident-modal .maintenance-start select").attr("disabled","disabled"),$("#update-incident-modal .maintenance-end input, #update-incident-modal .maintenance-end select").attr("disabled","disabled"))}),$("body").on("click","#update-incident-btn",function(e){var l=$(this).find("span.hide").text(),c=$(this).find("span#platform_id").text(),o="",r="",p=0,v="",u="";function m(e){return $.get("/api/v2/help_center/articles/"+e+".json")}"block"==$(".incident-container").css("display")&&(l=$(this).closest("div").children("span").text(),c=$(".incident-nav-item-active").find("span").text(),v=$(this).parent().parent().find("h5").text());var t=m(l);t.done(function(e){201265859===e.article.section_id&&(p=e.article.id,u=e.article.title),v=e.article.title,label=e.article.label_names;for(var t=0;t<label.length;t++)if(label[t].includes("RelatedIncidents:"))var a=label[t].replace("RelatedIncidents: ",""),i=a.split(" "),n=i.length;try{o+='<div id="related-incidents-container" class="incident-container-update-btn"><p id="related-incidents-label" class="incident-container-update-label">Related Incidents:</p>',r+='<label>Related Incidents Affected</label><div class="component-container">';for(var s=0;s<n;s++)!function(a){setTimeout(function(){var t=parseInt(i[a]),e=m(t);e.done(function(e){360000037612===e.article.section_id&&(section="MDX 2.0"),202580163===e.article.section_id&&(section="Sizmek Advertising Suite"),360000037572===e.article.section_id&&(section="DSP"),360000041291===e.article.section_id&&(section="DMP"),201265859===e.article.section_id&&(section="Internal"),o+='<div class="incident-item-action" id="related-incident"><a class="incident-item-view" href="/hc/en-us/articles/'+t+'">'+section+"</a><span>"+t+"</span></div>","Internal"!==section?r+='<div class="component"> <input class="affected-component" type="checkbox" value="'+t+'" checked><span>'+section+'</span><span id="incident-title" style="display:none;">'+e.article.title+"</span></div>":"Internal"===section&&(p=t,u=e.article.title),a+1===n&&d()})},100)}(s)}catch(e){}finally{setTimeout(function(){'<div id="related-incidents-container" class="incident-container-update-btn"><p id="related-incidents-label" class="incident-container-update-label">Related Incidents:</p>'===o&&(r=o="",d())},500)}function d(){$("body").append('<div class="modal" id="update-incident-modal"><div class="modal-content"><div class="modal-header"><button class="close close-modal">X</button><h1>Update Incident Status</h1></div> <div class="modal-body"> <div class="modal-body-detail"><label>Incident Status</label> <div class="status-choices"> <input type="radio" id="sc1" name="status-choices" value="Investigating"> <label class="radio-label" for="sc1">Investigating</label> <input type="radio" id="sc2" name="status-choices" value="Identified"><label class="radio-label" for="sc2">Identified </label> <input type="radio" id="sc3" name="status-choices" value="Monitoring"> <label class="radio-label" for="sc3">Monitoring</label> <input type="radio" id="sc4" name="status-choices" value="Resolved"> <label class="radio-label" for="sc4">Resolved </label> </div> </div><div class="modal-body-detail incident-severity"><label>Incident Severity</label><br><select><option value="1">Operational</option><option value="3">Degraded Performance</option><option value="4">Minor Outage</option><option value="5">Major Outage</option></select></div><div id="update-internal-message" class="modal-body-detail" style="padding: 20px;border: 1px solid #ababab;border-radius: 5px; background-color:#fffdf6;"> <label style="margin-bottom: 10px;font-size:18px;">Internal Message </label><label class="gswitch" id="switch-internal"><input type="checkbox" id="internal-message-switch"><span class="gslider round"></span></label><div class="modalOptions" style="clear: both; display: block;margin-bottom:30px">Send alert to subscribers<label class="gswitch"><input type="checkbox" id="send-comment-notif"><span class="gslider round green"></span></label></div><textarea id="update-incident-body-internal" class="message-internal" placeholder="Message"></textarea> </div><div class="components-affected-update"></div><div id="no-internal-incident"class="modal-body-detail" style="padding: 20px;border: 1px solid #ababab;border-radius: 5px; background-color:#F5FDFE;display:none;"> <label style="margin-bottom: 10px;font-size:18px;">No Related Internal Incident</label></div><div id="update-external-message" class="message-external" class="modal-body-detail" style="padding: 20px;border: 1px solid #ababab;border-radius: 5px; background-color:#F5FDFE; margin-top:20px;"> <label style="margin-bottom: 10px;font-size:18px;">External Message </label><div class="modalOptions" style="clear: both; display: block;margin-bottom:30px;">Send alert to subscribers<label class="gswitch"><input type="checkbox" id="send-comment-notif"><span class="gslider round green"></span></label></div><textarea id="update-incident-body-external" placeholder="Message"></textarea> </div></div><div class="modal-footer"><button class="btn btn-primary" id="update-incident-status">UPDATE STATUS<span class="hide">'+l+'</span><span id="incident-title" style="display:none;">'+v+"</span></button></div></div></div>"),$("#update-internal-message .gswitch input, #update-external-message .gswitch input").prop("checked",!0),$("html").css("overflow","hidden"),$("#update-incident-modal").fadeIn("fast"),$("textarea#update-incident-body-internal").ckeditor(),$("textarea#update-incident-body-external").ckeditor(),$("#update-internal-message .gswitch input, #update-external-message .gswitch input").prop("checked")?$("#send-comment-notif").prop("checked",!0):$("#send-comment-notif").prop("checked",!1),setTimeout(function(){r+='<div class="internal" style="display: none;"><span id="incident-id">'+p+'</span><span id="internal-title" style="display:none">'+u+"</span></div>",o+="</div>",r+="</div>",$("#update-incident-modal").find("textarea").val(""),$(".modal-content .modal-footer").prepend(o),$(".components-affected-update").prepend(r)},100),$("textarea#update-incident-body-internal").ckeditor(),CKEDITOR.instances["update-incident-body-internal"].on("instanceReady",function(e){setTimeout(function(){CKEDITOR.instances["update-incident-body-internal"].plugins.lite.findPlugin(CKEDITOR.instances["update-incident-body-internal"]).toggleTracking(!1,!1),$("#update-incident-message-modal").fadeIn("fast")},100)}),$("textarea#update-incident-body-external").ckeditor(),CKEDITOR.instances["update-incident-body-external"].on("instanceReady",function(e){setTimeout(function(){CKEDITOR.instances["update-incident-body-external"].plugins.lite.findPlugin(CKEDITOR.instances["update-incident-body-external"]).toggleTracking(!1,!1),$("#update-incident-message-modal").fadeIn("fast")},100)}),0===p&&($("#update-internal-message").css("display","none"),$("#no-internal-incident").css({display:"block","background-color":"#fffdf6"})),0!==p&&""===r&&($("#update-external-message").css("display","none"),$("#no-internal-incident").css("display","block").find("label").text("No Related External Incident")),c==b&&($('<div><label style="margin-bottom: 10px;font-size:18px;">Global Notifications </label><div class="modal-body-detail global-notifications" style="clear: both; display: block;margin-bottom:30px">Subscribe globalnotifications@sizmek.com.<label class="gswitch"><input type="checkbox" class="subscribe-global-notif"><span class="gslider round green"></span></label></div></div>').insertAfter(".modalOptions"),$(".modal-body-detail.global-notifications .gswitch input").prop("checked",!0),$("#updateMessage").css("background-color","#FFFDF6"),$(".modal-body-detail.global-notifications .gswitch input").prop("checked")?$(".subscribe-global-notif").prop("checked",!0):$(".subscribe-global-notif").prop("checked",!1)),$("#internal-message-switch").on("click",function(){$(this).is(":checked")?($("#send-comment-notif, #subscribe-global-notif").prop("checked",!0),$("#update-internal-message > div").fadeIn()):($("#send-comment-notif, #subscribe-global-notif").prop("checked",!1),$("#update-internal-message > div").fadeOut(),f=!1)})}})}),$("body").on("click","#update-incident-modal .close-modal",function(e){if($(this).closest(".modal").remove(),"hidden"!==$("html").css("overflow"))return!1;$("html").css("overflow","scroll")}),$("body").on("click",".edit_body a",function(e){var t=$(this).closest(".incident-list-item").find(".incident-item-cont span strong:first-child").text(),a=$(this).closest(".incident-list-item").find(".incident-item-cont span strong:nth-child(3)").text();if(""!=t&&""!=a)var i=$(this).closest(".incident-list-item").find(".incident-item-cont span.hide").html().replace(t,"").replace(a,""),i=i.substr(i.indexOf("<br><br>")+8),t=t.replace("Maintenance Start: ","").split(" ",2),a=a.replace("Maintenance End: ","").split(" ",2),n='<div class="maintenance-start"> <label>Maintenance Start Time </label> <div class="maintenance-time"> <input type="date" value="'+t[0]+'"> <select class="time-select"></select> </div> <span class="info">All times must be specified in EST - Eastern Standard Time(US &amp; Canada) </span> </div> <div class="maintenance-end"> <label>Maintenance End Time </label> <div class="maintenance-time"> <input value="'+a[0]+'" type="date"> <select class="time-select"></select> </div> <span class="info">All times must be specified in EST - Eastern Standard Time(US &amp; Canada) </span> </div>';else var i=$(this).closest(".incident-list-item").children(".article-body").children("span.hide").html(),n="";$("body").append('<div class="modal" id="update-incident-message-modal"><div class="modal-content"><div class="modal-header"><button class="close close-modal">X</button><h1>Edit Message</h1></div> <div class="modal-body">'+n+'<div class="modal-body-detail"> <label>Message </label> <br> <textarea id="update-incident-body" placeholder="Message">'+i+'</textarea> </div></div><div class="modal-footer"><button class="btn btn-primary" id="update-body-message">UPDATE MESSAGE</button></div></div></div>'),$("textarea#update-incident-body").ckeditor(),CKEDITOR.instances["update-incident-body"].on("instanceReady",function(e){setTimeout(function(){CKEDITOR.instances["update-incident-body"].plugins.lite.findPlugin(CKEDITOR.instances["update-incident-body"]).toggleTracking(!1,!1),$("#update-incident-message-modal").fadeIn("fast")},300)}),$("html").css("overflow","hidden"),$("#update-incident-message-modal").fadeIn("fast"),d(),$("textarea#update-incident-body").ckeditor(),$("#update-incident-message-modal .maintenance-start .time-select").val(t[1]),$("#update-incident-message-modal .maintenance-end .time-select").val(a[1])}),$("body").on("click","#update-incident-message-modal #update-body-message",function(e){$(this).attr("disabled","disabled");var t=$(".article-header .hide").text();if($("#update-incident-message-modal .maintenance-start").is(":visible"))var a=$('#update-incident-message-modal .maintenance-start input[type="date"]').val()+" "+$("#update-incident-message-modal .maintenance-start select").val(),i=$('#update-incident-message-modal .maintenance-end input[type="date"]').val()+" "+$("#update-incident-message-modal .maintenance-end select").val(),n=$("#update-incident-message-modal #update-incident-body").val(),s="<strong>Maintenance Start: "+a+"</strong><br><strong>Maintenance End: "+i+"</strong><br><br>"+n;else var s=$("#update-incident-message-modal #update-incident-body").val();$.ajax({url:"/api/v2/help_center/articles/"+t+"/translations/en-us.json",type:"PUT",data:{translation:{body:s}},success:function(){$("#update-incident-message-modal").remove(),location.reload()}})}),$("body").on("click",".edit_update a",function(){var e=$(this).closest(".incident-list-item").find(".incident-item-cont > span strong:first").text(),t=$(this).closest(".incident-list-item").find(".incident-item-cont > span strong:nth-child(3)").text(),a=$(this).children("span.hide").text(),i=$(this).closest(".incident-list-item").children(".incident-item-body").text();if(""!=e&&""!=t)var n=$(this).closest(".incident-list-item").find(".incident-item-cont span.hide").html().replace(e,"").replace(t,""),n=n.substr(n.indexOf("<br><br>")+8),e=e.replace("Maintenance Start: ","").split(" ",2),t=t.replace("Maintenance End: ","").split(" ",2),s='<div class="maintenance-start"> <label>Maintenance Start Time </label> <div class="maintenance-time"> <input type="date" value="'+e[0]+'"> <select class="time-select"></select> </div> <span class="info">All times must be specified in EST - Eastern Standard Time(US &amp; Canada) </span> </div> <div class="maintenance-end"> <label>Maintenance End Time </label> <div class="maintenance-time"> <input value="'+t[0]+'" type="date"><select class="time-select"></select> </div> <span class="info">All times must be specified in EST - Eastern Standard Time(US &amp; Canada) </span> </div>';else var n=$(this).closest(".incident-list-item").children(".incident-item-cont").children("span.span-body").html(),s="";$("body").append('<div class="modal" id="update-incident-message-modal"><div class="modal-content"><div class="modal-header"><button class="close close-modal">X</button><h1>Edit Message</h1></div> <div class="modal-body">'+s+'<div class="modal-body-detail"> <label>Message </label> <br> <textarea id="update-incident-body" placeholder="Message">'+n+'</textarea> </div></div><div class="modal-footer"><button class="btn btn-primary" id="update-update-message">UPDATE MESSAGE<span class="hide span-update_id">'+a+'</span><span class="hide span-update_status">'+i+"</span></button></div></div></div>"),$("textarea#update-incident-body").ckeditor(),CKEDITOR.instances["update-incident-body"].on("instanceReady",function(e){setTimeout(function(){CKEDITOR.instances["update-incident-body"].plugins.lite.findPlugin(CKEDITOR.instances["update-incident-body"]).toggleTracking(!1,!1),$("#update-incident-message-modal").fadeIn("fast")},300)}),d(),$("html").css("overflow","hidden"),$("#update-incident-message-modal .maintenance-start .time-select").val(e[1]),$("#update-incident-message-modal .maintenance-end .time-select").val(t[1])}),$("body").on("click","#update-incident-message-modal #update-update-message",function(){$(this).attr("disabled","disabled");var e=$(this).children("span.span-update_id").text(),t=$(this).children("span.span-update_status").text();if($(".incident-nav-header").children("span.hide").text(),$("#update-incident-message-modal .maintenance-start").is(":visible"))var a=$('#update-incident-message-modal .maintenance-start input[type="date"]').val()+" "+$("#update-incident-message-modal .maintenance-start select").val(),i=$('#update-incident-message-modal .maintenance-end input[type="date"]').val()+" "+$("#update-incident-message-modal .maintenance-end select").val(),n=$("#update-incident-message-modal #update-incident-body").val(),s="<strong>Maintenance Start: "+a+"</strong><br><strong>Maintenance End: "+i+"</strong><br><br>"+n;else var s=$("#update-incident-message-modal #update-incident-body").val();$.ajax({url:"/api/v2/help_center/articles/"+m+"/comments/"+e+".json",type:"PUT",data:{comment:{body:t+" - "+s}},success:function(){$("#update-incident-message-modal").remove(),location.reload()}})}),$("body").on("click",".delComment a",function(){var e=confirm("Delete comment?"),t=$(this).children("span.hide").text();1==e&&$.ajax({url:"/api/v2/help_center/articles/"+m+"/comments/"+t+".json",type:"DELETE",success:function(){location.reload()}})})}()})});var b=0,h=0;function o(){var o=0;$("#av-verify-article").prop("disabled",!0),$.get("/api/v2/search.json?query=custom_field_24296573:"+m).done(function(e){if($("#av-verify-article").prop("disabled",!1),0<e.count){var t=0;$(".av-related-tickets table tbody").empty();for(var a=0;a<e.count;a++)if("open"==e.results[a].status||"new"==e.results[a].status){t++,$(".av-related-tickets .noTickets").hide();var i=e.results[a].id,n=(e.results[a].subject,e.results[a].status),s=(e.results[a].requester_id,new Date(e.results[a].updated_at)),d='<tr class="related-tickets-item"><td><a href="/agent/tickets/'+i+'" target="_blank">'+('<span class="ticket_status_label ticket-status ticket-status-'+n+'" title="'+n+'">'+n.charAt(0).toLowerCase()+"</span>")+"&nbsp;#"+i+"</a></td><td>"+s.toDateString()+"</td></tr>";$("#av-open-related-tickets").append(d);var l=e.results[a].tags;-1<l.indexOf("article_flagged_reason_outdated_information")&&c(6),-1<l.indexOf("review_a_flagged_article")&&c(5)}0<t?(c(2),$(".av-related-tickets table").show()):(c(1),$(".av-verify-error").hide(),$(".av-related-tickets .noTickets").show(),$(".av-related-tickets table").hide())}else c(1),$(".av-related-tickets table").hide(),$(".av-related-tickets noTickets").show(),$(".av-verify-error").hide();function c(e){(0==o||o<e||e==o)&&(o=e)}T(o)})}function g(e){var t=new Date(e),a=new Date,i=new Date;i.setHours(15),i.setDate(i.getDate()-1);var n=l[t.getMonth()],s=t.getFullYear(),d=t.getDate();t.setHours(0,0,0,0)==a.setHours(0,0,0,0)?$("#av-last-vdate").text("TODAY"):t.setHours(0,0,0,0)==i.setHours(0,0,0,0)?$("#av-last-vdate").text("YESTERDAY"):$("#av-last-vdate").text(n+" "+d+", "+s)}function c(e){var t='{"label":{"name":"!av::details::'+e.date+"::"+e.interval+"::"+e.verifier+'"}}',a=JSON.parse(t);$.ajax({url:"/api/v2/help_center/articles/"+m+"/labels.json",method:"POST",data:a,success:function(){!function(e){var t=parseInt(e.interval),a=new Date(e.date);a.setMonth(a.getMonth()+t);var i=a.getFullYear(),n=function(e){var t=e;e<10&&(t="0"+e);return t}(a.getMonth()+1),s=function(e){var t=e;e<10&&(t="0"+e);return t}(a.getDate()),d={label:{name:"!av::YYYY::"+i}},l={label:{name:"!av::MM::"+n}},c={label:{name:"!av::DD::"+s}};$.ajax({url:"/api/v2/help_center/articles/"+m+"/labels.json",method:"POST",data:d,error:function(){r()},success:function(){$.ajax({url:"/api/v2/help_center/articles/"+m+"/labels.json",method:"POST",data:l,error:function(){r()},success:function(){$.ajax({url:"/api/v2/help_center/articles/"+m+"/labels.json",method:"POST",data:c,error:function(){r()},success:function(){$("#sideNavigation ").css("border-top","3px solid #00e8c6"),$(".nav-border").css("border-top","3px solid #00e8c6"),$("#av-header").removeClass().addClass("av-success"),$("#av-header").find(".av-status").text("TRUSTED"),$("#av-header").find("i").removeClass().addClass("fa fa-check"),$("#av-last-verifier").text(e.verifier),$("#av-interval-select").val(e.interval),y(e.interval),g(e.date),$("#av-verify-article").prop("disabled",!1),$("#av-verify-article").find("span").text("VERIFY ARTICLE"),$("#av-verify-article").find("i").hide(),$("#av-verify-article").removeClass("av-danger"),o()}})}})}})}(e)},error:function(){r()}})}function y(a){$(".k-selected").prev(".k-select").find(">ul").empty(),$(".k-selected option").each(function(){var e=$(this).text(),t=$(this).val();a==t?($(this).parent().prev(".k-select").find("span").first().html(e),$(this).parent().prev(".k-select").find("ul").append('<li style="display:none">'+e+"<span>"+t+"</span></li>")):$(this).parent().prev(".k-select").find("ul").append("<li>"+e+"<span>"+t+"</span></li>")})}function k(e){(0==b||b<e||e==b)&&(b=e)}function T(e){switch(e){case 1:$("#av-header").removeClass().addClass("av-success"),$("#av-header").find("i").removeClass().addClass("fa fa-check"),$("#av-header").find(".av-status").text("TRUSTED"),$("#sideNavigation ").css("border-top","3px solid #00e8c6"),$(".nav-border").css("border-top","3px solid #00e8c6");break;case 2:$("#av-header").find(".av-status").text("PENDING APPROVAL"),$("#av-header").find("i").removeClass().addClass("fa fa-warning"),$("#av-header").removeClass().addClass("av-warning"),$("#sideNavigation ").css("border-top","3px solid #e0b21e"),$(".nav-border").css("border-top","3px solid #e0b21e");break;case 3:$("#av-header").find(".av-status").text("PENDING VERIFICATION"),$("#av-header").find("i").removeClass().addClass("fa fa-warning"),$("#av-header").removeClass().addClass("av-default"),$("#sideNavigation ").css("border-top","3px solid #b4b4b4"),$(".nav-border").css("border-top","3px solid #b4b4b4");break;case 4:$("#av-header").find(".av-status").text(h+" DAYS UNTIL VERIFICATION"),$("#av-header").find("i").removeClass().addClass("fa fa-warning"),$("#av-header").removeClass().addClass("av-warning"),$("#sideNavigation ").css("border-top","3px solid #e0b21e"),$(".nav-border").css("border-top","3px solid #e0b21e");break;case 5:$("#av-header").find(".av-status").text("FLAGGED"),$("#av-header").find("i").removeClass().addClass("fa fa-warning"),$("#av-header").removeClass().addClass("av-danger"),$("#sideNavigation ").css("border-top","3px solid #df2828"),$(".nav-border").css("border-top","3px solid #df2828");break;case 6:$(".av-related-tickets table").show(),$("#av-header").find(".av-status").text("OUT OF DATE"),$("#av-header").find("i").removeClass().addClass("fa fa-warning"),$("#av-header").removeClass().addClass("av-danger"),$("#sideNavigation ").css("border-top","3px solid #df2828"),$(".nav-border").css("border-top","3px solid #df2828")}}function r(){$("#av-verify-article").prop("disabled",!1),$("#av-verify-article").find("span").text("FAILED - RETRY?"),$("#av-verify-article").addClass("av-danger")}$("#av-verify-article").on("click",function(){0!=$("#av-interval-select").val()||"0"!=$("#av-interval-select").val()?($(".av-interval-error").hide(),$(this).find("span").text("LOADING..."),$(this).prop("disabled",!0),$(this).find("i").show(),$.get("/api/v2/search.json?query=custom_field_24296573:"+m).done(function(e){for(var t=0,a=0;a<e.count;a++)"new"!=e.results[a].status&&"open"!=e.results[a].status||-1<e.results[a].tags.indexOf("review_a_flagged_article")&&t++;if(0==t){var i=(new Date).toISOString(),n=HelpCenter.user.name,l={date:i,interval:$("#av-interval-select").val(),verifier:n};$.get("/api/v2/help_center/articles/"+m+"/labels.json").done(function(e){if(0<e.labels.length){for(var t=[],a=0;a<e.labels.length;a++)if(0==e.labels[a].name.indexOf("!av::")){var i=e.labels[a].id;t.push(i)}0<t.length?(n=t,s=l,d=0,function e(){n[d],$.ajax({url:"/api/v2/help_center/articles/"+m+"/labels/"+n[d]+".json",method:"DELETE",error:function(){},success:function(){++d>=n.length?c(s):e()}})}()):c(l),$(".av-related-tickets").find(".av-verify-error").hide()}else c(l),$(".av-related-tickets").find(".av-verify-error").hide();var n,s,d})}else $(".av-related-tickets").find(".av-verify-error").fadeOut("fast"),$(".av-related-tickets").find(".av-verify-error").fadeIn("slow"),$("#av-verify-article").prop("disabled",!1),$("#av-verify-article").find("span").show(),$("#av-verify-article").find("i").hide(),$("#av-verify-article").find("span").text("VERIFY ARTICLE"),o()})):($(".av-interval-error").fadeOut(),$(".av-interval-error").fadeIn())})}});